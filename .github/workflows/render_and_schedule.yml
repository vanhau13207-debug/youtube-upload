- name: Remove ALL pip cache and numpy leftovers
  run: |
    pip cache purge || true
    rm -rf ~/.cache/pip
    rm -rf /usr/local/lib/python3.10/site-packages/numpy*
    rm -rf /usr/local/lib/python3.10/dist-packages/numpy*

- name: Force override numpy version
  run: |
    echo "numpy==1.22.0" > numpy_override.txt
    pip install --upgrade pip
    pip install --no-cache-dir --force-reinstall --no-deps -r numpy_override.txt

- name: Install deps ignoring dependency resolver
  run: |
    pip install --no-cache-dir --no-deps -r requirements_final.txt
